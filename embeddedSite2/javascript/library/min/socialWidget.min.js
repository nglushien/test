define(function(){return{init:function(){if("undefined"!=typeof socialFeed&&1==socialFeed){for(var e=[socialFeedHasTwitter,socialFeedHasFacebook,socialFeedHasRSS],t=e.length,a=0,s=0;t>s;s++)1==e[s]&&a++;$("#micrositeSocialFeeds").addClass("count"+a);var i=function(){function e(){$(".micrositeSocialFeedNavRSSTab").click(function(){s="rss"}),$(".micrositeSocialFeedNavFacebookTab").click(function(){s="facebook"}),$(".micrositeSocialFeedNavTwitterTab").click(function(){s="twitter"})}function t(){$(".micrositeSocialFeedNavRSSTab").hasClass("active")?($(".micrositeSocialFeedRSSPanel").css("display","block"),$(".micrositeSocialFeedTwitterPanel").css("display","none"),$(".micrositeSocialFeedFacebookPanel").css("display","none"),$(".micrositeSocialFeedFooter").html("<a href="+u+' target="_blank"><div class="micrositeSocialFeedFooterCTA">View more blog posts</div></a>')):$(".micrositeSocialFeedNavTwitterTab").hasClass("active")?($(".micrositeSocialFeedTwitterPanel").css("display","block"),$(".micrositeSocialFeedRSSPanel").css("display","none"),$(".micrositeSocialFeedFacebookPanel").css("display","none"),$(".micrositeSocialFeedFooterCTA").html("Follow "+p).wrap("<a href="+d+' target="_blank"></a>')):$(".micrositeSocialFeedNavFacebookTab").hasClass("active")&&($(".micrositeSocialFeedFacebookPanel").css("display","block"),$(".micrositeSocialFeedRSSPanel").css("display","none"),$(".micrositeSocialFeedTwitterPanel").css("display","none"),$(".micrositeSocialFeedFooterCTA").html("Like us at "+f).wrap("<a href="+w+' target="_blank"></a>'))}var s="micrositeSocialFeedNav"+startActive+"Tab";$("."+s).addClass("active");var i="micrositeSocialFeedNav"+startActive+"Panel";$("."+i).css("display","block"),t(),e(),$(".micrositeSocialFeedNav ul li").on("click",function(e){e.preventDefault(),$(this).siblings().hasClass("active")&&($(this).siblings().removeClass("active"),$(this).addClass("active")),t()}),2>a&&$(".micrositeSocialFeedNav ul li").css("cursor","default")},o='<div class="socialFeedMissingErrorMessage"><h2>Sorry</h2><p>Feed is temporarily unavailable.</p></div>',c=function(){var e="-1"!=window.location.hostname.indexOf(".eng.")?"yahooql.eng.techtarget.com":"-1"!=window.location.hostname.indexOf(".qa.")?"yahooql.qa.techtarget.com":"yahooql.techtarget.com";$(".viewAllBlogPosts").attr("href",m);var t='<li class="rssRow"><h4></h4><span class="rssPubDateDay"></span> <span class="rssPubDate"></span></div><p class="rssLink"></p></li>';$.ajax({type:"GET",url:"http://"+e+"/rss_json.php?rssFeedSource="+encodeURIComponent(m),dataType:"jsonp",crossDomain:!0,success:function(e){if("undefined"==typeof e.query)$(".spinningBoxes").css("display","none"),$(".micrositeSocialFeedRSSPanel #rssFeed").html('<p class="errorMessage">There was an error loading the RSS feed. <a href="'+u+'" target="_blank">Visit the feed directly here.</a></p>');else{for($(".spinningBoxes").css("display","none"),s=0;3>s;s++){$(".micrositeSocialFeedRSSPanel #rssFeed ul").append(t),rssDateNativeFormat=e.query.results.item[s].pubDate,rssDateSplitFormat=rssDateNativeFormat.split(" "),rssDateDayofMonth=rssDateSplitFormat[1];var a=rssDateSplitFormat[3];rssDateMonthYear=rssDateSplitFormat[2]+a.substr(2),$(".rssRow:nth-of-type("+(s+1)+") .rssPubDateDay").html(rssDateDayofMonth),$(".rssRow:nth-of-type("+(s+1)+") .rssPubDate").html(rssDateMonthYear),$(".rssRow:nth-of-type("+(s+1)+") h4").html('<a href="'+e.query.results.item[s].link+'" target="_blank" + data-track="'+e.query.results.item[s].link+'" title="View this feed">'+e.query.results.item[s].title+"</a>"),$(".rssRow:nth-of-type("+(s+1)+") .rssLink").html('<a href="'+e.query.results.item[s].link+'" target="_blank" + data-track="'+e.query.results.item[s].link+'" title="View this feed">Read More</a>')}$(".viewAllBlogPosts").css("display","block")}}})},n=function(){var e="-1"!=window.location.hostname.indexOf(".eng.")?"twitter.eng.techtarget.com":"-1"!=window.location.hostname.indexOf(".qa.")?"twitter.qa.techtarget.com":"twitter.techtarget.com",t=12,a=0,i='<li class="clearfix"><div class="twitterAvatarContainer"><img class="twitterAvatar"/></div><div class="tweetContent"><p><a class="twitterUserName" data-tweet-id="placeholder" target="_blank"></a> <a class="twitterUserHandle1" data-tweet-id="placeholder" target="_blank"></a><a class="tweetDate" data-tweet-id="placeholder" target="_blank"></a><br/><a class="twitterUserHandle2" data-tweet-id="placeholder" target="_blank"></a></p><div class="tweet" ><span class="tweetText"></span></div></div><div class="tweetIntents"></div></li>',c=/((([A-Za-z]{3,9}:(?:\/\/)?)(?:[-;:&=\+\$,\w]+@)?[A-Za-z0-9.-]+|(?:www.|[-;:&=\+\$,\w]+@)[A-Za-z0-9.-]+)((?:\/[\+~%\/.\w-_]*)?\??(?:[-\+=&;%@.\w_]*)#?(?:[\w]*))?)/g,n=/#(\S+)/g,l=/@(\S+)/g,d=new String,p=new String,h=new Array;for(s=0;t>s;s++)$(".tweets").append(i);$.ajax({type:"GET",url:"http://"+e+"/twitter_json.php?count="+t+"&screen_name="+r,dataType:"jsonp",crossDomain:!0,success:function(e){$(".spinningBoxes").css("display","none"),$("#twitterfeed").css("display","block");var i,o;for(s=0;t>s;s++){a=e[s].id_str,$(".tweets li:nth-of-type("+(s+1)+") a").attr("data-tweet-id",e[s].id_str),$(".tweets li:nth-of-type("+(s+1)+") .tweetDate").attr("href","https://twitter.com/"+r+"/status/"+e[s].id_str),$(".tweets li:nth-of-type("+(s+1)+") .twitterUserName").html(e[s].user.name).attr("href","https://twitter.com/"+r),$(".tweets li:nth-of-type("+(s+1)+") .twitterUserHandle1").html(" @"+e[s].user.screen_name).attr("href","https://twitter.com/"+r),$(".tweets li:nth-of-type("+(s+1)+") .twitterUserHandle2").html(" @"+e[s].user.screen_name).attr("href","https://twitter.com/"+r),$(".tweets li:nth-of-type("+(s+1)+") .twitterAvatar").attr("src",e[s].user.profile_image_url),p=e[s].created_at,tweetDateSplitFormat=p.split(" "),h=tweetDateSplitFormat[1]+" "+tweetDateSplitFormat[2],$(".tweets li:nth-of-type("+(s+1)+") .tweetDate").html(h),d=e[s].text,void 0!=d&&0!=d.length&&$(".tweets li:nth-of-type("+(s+1)+") .tweetText").html(d.replace(c,'<a class="inLineLink" href="$&" data-tweet-id="'+e[s].id_str+'" target="_blank">$&</a>').replace(n,'<a class="hashLink" href="http://twitter.com/#!/search/$1" data-tweet-id="'+e[s].id_str+'" target="_blank">#$1</a>').replace(l,'<a class="handleLink" href="http://twitter.com/$1" data-tweet-id="'+e[s].id_str+'" target="_blank">@$1</a>'));var w;$(".inLineLink").each(function(){"."==$(this).html().substr(-1)&&(w=$(this).html().slice(0,-1),$(this).attr("href",w))}),$(".handleLink").each(function(){":"==$(this).html().substr(-1)&&(w=$(this).html().slice(0,-1),$(this).attr("href","http://twitter.com/"+w))}),i=e[s].retweet_count,o=e[s].favorite_count,$(".tweets li:nth-of-type("+(s+1)+") .tweetIntents").html('<a class="replyIntentLink" target="_blank" data-tweet-id="'+e[s].id_str+'" href="https://twitter.com/intent/tweet?in_reply_to='+a+'"><i class="icon-reply"></i><span>Reply</span></a><a class="retweetIntentLink" target="_blank" data-tweet-id="'+e[s].id_str+'" href="https://twitter.com/intent/retweet?tweet_id='+a+'"><i class="icon-retweet"></i><span>Retweet</span></a><span class="micrositeSocialFeedTwitterRetweeted">'+i+'</span><a class="favoriteIntentLink" target="_blank" data-tweet-id="'+e[s].id_str+'" href="https://twitter.com/intent/favorite?tweet_id='+a+'"><i class="icon-favorite"></i><span>Favorite</span></a><span class="micrositeSocialFeedTwitterFavorited">'+o+"</span>"),0===i&&$(".tweets").find(".micrositeSocialFeedTwitterRetweeted").eq(s).css("display","none"),0===o&&$(".tweets").find(".micrositeSocialFeedTwitterFavorited").eq(s).css("display","none")}},error:function(){$(".spinningBoxes").css("display","none"),$("#twitterfeed").css("display","block").html(o)}})},l=function(){var e,t="-1"!=window.location.hostname.indexOf(".eng.")?"facebook.eng.techtarget.com":"-1"!=window.location.hostname.indexOf(".qa.")?"facebook.qa.techtarget.com":"facebook.techtarget.com",a='<li><p><a href="" target="_blank" class="facebookLink"><span class="facebookUser"></span></a><a href="" target="_blank" class="facebookLink"><span class="facebookStatusDate"></span></a></p><div class="facebookStatuses"><a href="" target="_blank" class="facebookLink"><p class="facebookStatus"></p></a><p class="facebookCTA"><a href="" target="_blank" class="facebookLink"><span>View Now</span></a></p></div></li>',i=10,c=new String,n=new String,l=new String,r=new String,d=new String,p=new String,w=(new String,new Array("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"));$.ajax({type:"GET",url:"http://"+t+"/facebook_json.php?facebookName="+h+"&facebookCount="+i,dataType:"jsonp",crossDomain:!0,success:function(t){if(t){for($("#facebookfeed").css("display","block"),s=0;i>s;s++)$(".facebookstatusupdates").append(a),c=t.data[s].from.name,n=t.data[s].id.split("_"),l="http://www.facebook.com/"+n[0]+"/posts/"+n[1],$(".facebookstatusupdates li:nth-of-type("+(s+1)+") .facebookUser").html(c),$(".facebookstatusupdates li:nth-of-type("+(s+1)+") .facebookLink").attr("href",l),$(".facebookstatusupdates li:nth-of-type("+(s+1)+") .facebookStatus").html(t.data[s].message),r=t.data[s].picture,void 0!=r&&($(".facebookstatusupdates li:nth-of-type("+(s+1)+") .facebookStatusPictureContainer").css("display","block"),$(".facebookstatusupdates li:nth-of-type("+(s+1)+") .facebookStatusPicture").css("display","block")),d=t.data[s].created_time.split("-"),e=parseInt(d[1]),p=w[e-1]+" "+d[2].substring(0,2),$(".facebookstatusupdates li:nth-of-type("+(s+1)+") .facebookStatusDate").html(p);$(".spinningBoxes").css("display","none")}else $(".spinningBoxes").css("display","none"),console.log("wtf"),$(".micrositeSocialFeedFacebookPanel").html(o)},error:function(){$(".spinningBoxes").css("display","none"),$("#facebookFeed").css("display","block"),$(".micrositeSocialFeedFacebookPanel").html("hi!")}})};if(1==e[0]){var r=socialFeedTwitterAccount,d="https://twitter.com/@"+r,p=socialFeedTwitterAccountName;$(".micrositeSocialFeedNav ul").append('<li class="micrositeSocialFeedNavTwitterTab"><i class="icon-twitter"></i><span>Latest Tweets</span></li>'),$(".micrositeSocialFeedContent > ul").append('<li class="micrositeSocialFeedTwitterPanel"><div id="twitterfeed"><ul class="tweets"></ul></div></li>'),n()}if(1==e[1]){var h=socialFeedFacebookAccount,w="https://www.facebook.com/"+h,f=socialFeedFacebookAccountName;$(".micrositeSocialFeedNav ul").append('<li class="micrositeSocialFeedNavFacebookTab"><i class="icon-facebook"></i><span>Latest Updates</span></li>'),$(".micrositeSocialFeedContent > ul").append('<li class="micrositeSocialFeedFacebookPanel"><div id="facebookfeed"><ul class="facebookstatusupdates"></ul></div></li>'),l()}if(1==e[2]){var m=socialFeedRSSAccount,u=socialFeedRSSLinkURL;$(".micrositeSocialFeedNav ul").append('<li class="micrositeSocialFeedNavRSSTab"><i class="icon-rss"></i><span>Latest Posts</span></li>'),$(".micrositeSocialFeedContent > ul").append('<li class="micrositeSocialFeedRSSPanel"><div id="rssFeed"><ul></ul></div></li>'),c()}$(window).on("scroll",function(){($(".sponsorInfoPanel").hasClass("show")&&$(window).scrollTop()>$(".header").outerHeight(!0)||$(".micrositeSocialMenu").hasClass("show")&&$(window).scrollTop()>$(".header").outerHeight(!0))&&hidePopups()}),i()}}}});